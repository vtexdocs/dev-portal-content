---
title: "Implementing Delivery Promise"
updatedAt: "2025-08-15T14:36:33.694Z"
---

>ℹ This feature is in closed beta, which means that only selected customers have access to it. If you're interested in implementing it in the future, please contact our [Support](https://support.vtex.com/hc/en-us) team.

In this guide, you’ll learn how to configure Delivery Promise in your FastStore project.

To understand how Delivery Promise works, see the guide [Delivery Promise (beta)](https://developers.vtex.com/docs/guides/faststore/features-delivery-promise-overview).

## Default settings

Delivery Promise is defined in the `deliveryPromise` section of the [`discovery.config.js`](https://developers.vtex.com/docs/guides/faststore/project-structure-config-options) file.

The default settings are:

```js discovery.config.js
deliveryPromise: {
    enabled: true,
    mandatory: false
  },
```

* `enabled`: When set to **true**, Delivery Promise is activated, allowing the store to provide delivery estimates based on user location.
* `mandatory`: When set to **false**, providing a postal code is optional for the user. Users can browse and add items to the cart without entering their postal code, though the accuracy of delivery information may be limited.

## Before you begin

<Steps>

### Get the `search-session` app

Check if you have version `0.5.0` or later of the [`search-session`](https://developers.vtex.com/docs/apps/vtex.search-session) app installed.

1. In your terminal, run the `vtex list` command.
2. In the returned results, search for the app.
3. If you don’t have this app installed, run the command `vtex install vtex.search-session`.

### Enable the VTEX Intelligent Search app

To enable the Intelligent Search app, check the version of your [Edition Store](https://developers.vtex.com/docs/guides/vtex-io-documentation-edition-app) account.

In your terminal, log in to your account by running `vtex login {accountName}` and run `vtex edition get` to see the Edition app version installed. *Remember to replace the values between curly braces with your account name*.

<details>
<summary>Accounts with `vtex.edition-store@5.x`</summary>

If your account is using the `vtex.edition-store@5.x` major, the VTEX Intelligent Search app is already included, and you need to integrate it via the VTEX Admin.

To integrate VTEX Intelligent Search, go to **Store Settings > Intelligent Search > Integrations** in the VTEX Admin, and click `START INTEGRATION`.

</details>

<details>
<summary>Accounts with an edition version older than `5.x`</summary>

1. In the VTEX IO CLI, log in to your VTEX account by running `vtex login {accountName}`. *Remember to replace the values between curly braces with your account name.*
2. If the VTEX Intelligent Search app isn't installed in your account, run the following command:

    ```bash
    vtex install vtex.search-resolver@1.x vtex.admin-search@1.x
    ```

After installing the app, integrate it by going to **Store Settings > Intelligent Search > Integrations** in the VTEX Admin, and clicking `START INTEGRATION`.

</details>

<details>
<summary>Accounts that want to migrate to version `5.x`</summary>

If you're using a different major version and want to migrate, please [open a ticket with VTEX Support](https://help.vtex.com/en/support) and request the installation of Edition app `vtex.edition-store@5.x`.

</details>

### Update the `@faststore/cli` package

Run the `yarn upgrade @faststore/cli` command to update the `@faststore/cli` package to the latest version.

  ### Open a ticket with VTEX Support

Open a ticket with [VTEX Support](https://help.vtex.com/en/support) and request the activation of Delivery Promise in your account.

</Steps>

## Instructions

### Step 1 - Enabling `deliveryPromise`

1. Open your FastStore project using the code editor of your choice.
2. Open the [`discovery.config.js`](https://developers.vtex.com/docs/guides/faststore/project-structure-config-options) file.
3. Under the [`deliveryPromise`](https://developers.vtex.com/docs/guides/faststore/project-structure-config-options#deliverypromise) section, set the `enabled` value to `true`. Set the `mandatory` value based on your business needs. Learn more in the [Default settings](#default-settings) section.

    ```js discovery.config.js
    deliveryPromise: {
      enabled: true,
      mandatory: false,
    }
    ```

### Step 2 - Syncing your FastStore project with Headless CMS

Run the `faststore cms-sync` command to sync the `cms` folder of your FastStore project with [Headless CMS](https://developers.vtex.com/docs/guides/faststore/headless-cms-overview).

The expected response is the message `CMS synced successfully...`. The native regionalization components and sections will be automatically updated. You can check them in the VTEX Admin:

- **Regionalization component:** Go to **Storefronts > Headless CMS > Global Sections > NavBar > Navigation > Regionalization**.

- **Region Bar section:** Go to **Storefronts > Headless CMS > Global Sections > Region Bar**.

- **Region Modal section:** Go to **Storefronts > Headless CMS > Global Sections > Region Modal**.

You only need to [add a new section](#step-3-adding-region-popover-section): `Region Popover`.

### Step 3 - Adding the `Region Popover` section

`RegionPopover` is a section that manages user location inputs. It's used when location data is missing or the store default postal code is applied. `RegionPopover` is available in [`@faststore/core`](https://developers.vtex.com/docs/guides/faststore/project-structure-overview#packagejson) and uses the [`Popover`](https://developers.vtex.com/docs/guides/faststore/molecules-popover) component as its UI base.

![regionpopover](https://vtexhelp.vtexassets.com/assets/docs/src/regionpopover___dedb0aad756657e71d4c8d40cb2ef5e7.png)

<details>
<summary>`RegionPopover` code</summary>
```tsx packages/core/src/components/region/RegionPopover/RegionPopover.tsx
import type { PopoverProps as UIPopoverProps } from '@faststore/ui'
import {
  Icon as UIIcon,
  InputField as UIInputField,
  Link as UILink,
  Popover as UIPopover,
  useUI,
} from '@faststore/ui'
import { useRef, useState } from 'react'

import useRegion from '../RegionModal/useRegion'

import { sessionStore, useSession } from 'src/sdk/session'
import { textToTitleCase } from 'src/utils/utilities'
import styles from './section.module.scss'

interface RegionPopoverProps {
  title?: UIPopoverProps['title']
  closeButtonAriaLabel?: UIPopoverProps['closeButtonAriaLabel']
  inputField?: {
    label?: string
    errorMessage?: string
    noProductsAvailableErrorMessage?: string
    buttonActionText?: string
  }
  idkPostalCodeLink?: {
    text?: string
    to?: string
    icon?: {
      icon?: string
      alt?: string
    }
  }
  textBeforeLocation?: string
  textAfterLocation?: string
  description?: string
  triggerRef?: UIPopoverProps['triggerRef']
  onDismiss: UIPopoverProps['onDismiss']
  offsetTop?: UIPopoverProps['offsetTop']
  offsetLeft?: UIPopoverProps['offsetLeft']
  placement?: UIPopoverProps['placement']
}

function RegionPopover({
  title = 'Set your location',
  closeButtonAriaLabel,
  inputField: {
    label: inputFieldLabel,
    errorMessage: inputFieldErrorMessage,
    noProductsAvailableErrorMessage: inputFieldNoProductsAvailableErrorMessage,
    buttonActionText: inputButtonActionText,
  },
  idkPostalCodeLink: {
    text: idkPostalCodeLinkText,
    to: idkPostalCodeLinkTo,
    icon: { icon: idkPostalCodeLinkIcon, alt: idkPostalCodeLinkIconAlt },
  },
  textBeforeLocation = 'Your current location is:',
  textAfterLocation = 'Use the field below to change it.',
  description = 'Offers and availability vary by location.',
  triggerRef,
  offsetTop = 6,
  offsetLeft,
  placement = 'bottom-start',
}: RegionPopoverProps) {
  const inputRef = useRef<HTMLInputElement>(null)
  const { isValidating, ...session } = useSession()
  const { popover: displayPopover, closePopover } = useUI()
  const { city, postalCode } = sessionStore.read()
  const location = city ? `${textToTitleCase(city)}, ${postalCode}` : postalCode

  const [input, setInput] = useState<string>('')

  const { loading, setRegion, regionError, setRegionError } = useRegion()

  const handleSubmit = async () => {
    if (isValidating) {
      return
    }

    await setRegion({
      session,
      onSuccess: () => {
        setInput('')
        closePopover()
      },
      postalCode: input,
      errorMessage: inputFieldErrorMessage,
      noProductsAvailableErrorMessage:
        inputFieldNoProductsAvailableErrorMessage,
    })
  }

  const idkPostalCodeLinkProps = {
    href: idkPostalCodeLinkTo,
    children: (
      <>
        {idkPostalCodeLinkText}
        {!!idkPostalCodeLinkIcon && (
          <UIIcon
            name={idkPostalCodeLinkIcon}
            aria-label={idkPostalCodeLinkIconAlt}
            width={20}
            height={20}
          />
        )}
      </>
    ),
  }

  const RegionPopoverContent = (
    <>
      <span data-fs-region-popover-description>
        {postalCode ? (
          <>
            {textBeforeLocation} <span>{location}</span>. {textAfterLocation}
          </>
        ) : (
          <>{description}</>
        )}
      </span>
      <UIInputField
        data-fs-region-popover-input
        id="region-popover-input-postal-code"
        inputRef={inputRef}
        label={inputFieldLabel}
        actionable
        value={input}
        onInput={(e) => {
          regionError !== '' && setRegionError('')
          setInput(e.currentTarget.value)
        }}
        onSubmit={handleSubmit}
        onClear={() => {
          setInput('')
          setRegionError('')
        }}
        buttonActionText={loading ? '...' : inputButtonActionText}
        error={regionError}
      />
      {idkPostalCodeLinkTo && (
        <UILink data-fs-region-popover-link {...idkPostalCodeLinkProps} />
      )}
    </>
  )

  return (
    <>
      {displayPopover.isOpen && (
        <div className={`${styles.section} section-region-popover`}>
          <UIPopover
            data-fs-region-popover
            title={title}
            isOpen={displayPopover.isOpen}
            content={RegionPopoverContent}
            placement={placement}
            dismissible
            triggerRef={triggerRef}
            offsetTop={offsetTop}
            offsetLeft={offsetLeft}
            closeButtonAriaLabel={closeButtonAriaLabel}
            onEntered={() => {
              if (!postalCode && inputRef.current) {
                inputRef.current.focus()
              }
            }}
          />
        </div>
      )}
    </>
  )
}

export default RegionPopover
```
</details>

Follow the steps below to add the `RegionPopover` section to Headless CMS.

1. In the VTEX Admin, go to **Storefront > Headless CMS > Global Sections**.
2. In the Sections tab, click `+` to open a modal with a list of section options.
3. Search for the **Region Popover** section and click it to add it.
4. Set the `Title` and `Close popover aria-label` fields with your values.
5. Click `Save` to save your changes.
6. Click `Publish` to open a dropdown list with the options `Add to Release` (to schedule the update) and `Publish now` (to publish immediately).

Learn more in [Adding sections to Headless CMS](https://developers.vtex.com/docs/guides/faststore/headless-cms-3-adding-content-types-and-sections#step-3-adding-sections-to-the-headless-cms)

### Step 4 - (Optional) Defining a default postal code

The default postal code is a fallback mechanism when users don't provide a location, aren't logged in, or have no saved address.

To set a default postal code for your store, follow the steps below:

1. Open your FastStore project using the code editor of your choice.
2. Open the [`discovery.config.js`](https://developers.vtex.com/docs/guides/faststore/project-structure-config-options) file.
3. In the [`session`](https://developers.vtex.com/docs/guides/faststore/project-structure-config-options#session) object, set your default `postalCode`. See the example below:

     ```js discovery.config.js mark=12
      session: {
        currency: {
          code: "USD",
          symbol: "$",
        },
        locale: "en-US",
        channel: '{"salesChannel":"1","regionId":""}',
        country: "USA",
        deliveryMode: null,
        addressType: null,
        city: null,
        postalCode: 10021,
        geoCoordinates: null,
        person: null,
      },
      ```
